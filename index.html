<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Invoice Generator | SiteArche</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #7209b7;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            color: white;
        }
        
        h1 {
            margin-bottom: 10px;
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .form-section, .preview-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            font-size: 1.3rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .row {
            display: flex;
            gap: 15px;
        }
        
        .row .form-group {
            flex: 1;
        }
        
        .tax-section {
            background: rgba(67, 97, 238, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid var(--primary);
        }
        
        .tax-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .tax-name {
            flex: 2;
        }
        
        .tax-rate {
            flex: 1;
        }
        
        .tax-actions {
            flex: 0.5;
            display: flex;
            gap: 5px;
        }
        
        .tax-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .tax-btn.remove {
            background: var(--danger);
        }
        
        .add-tax {
            background: var(--info);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        .products-section {
            margin-top: 30px;
        }
        
        .product-item {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .remove-product {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .remove-product:hover {
            background: #d1144a;
            transform: translateY(-2px);
        }
        
        .add-product {
            background: var(--success);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            transition: all 0.3s;
            width: 100%;
            justify-content: center;
        }
        
        .add-product:hover {
            background: #3aa8d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .invoice-status {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-option {
            flex: 1;
            text-align: center;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .status-option.active {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .status-paid.active {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .status-unpaid.active {
            border-color: #f04438;
            background: rgba(240, 68, 56, 0.1);
            color: #f04438;
        }
        
        .status-partial.active {
            border-color: #f79009;
            background: rgba(247, 144, 9, 0.1);
            color: #f79009;
        }
        
        .generate-btn {
            width: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 10px;
            padding: 18px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
        }
        
        .preview-container {
            background: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 25px;
            min-height: 600px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        .invoice-preview {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            min-height: 540px;
        }
        
        .invoice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .invoice-title {
            font-size: 2.2rem;
            color: var(--primary);
            font-weight: bold;
        }
        
        .invoice-id {
            font-size: 1.3rem;
            color: var(--dark);
            margin-top: 5px;
        }
        
        .company-info, .client-info {
            margin-bottom: 30px;
        }
        
        .info-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--secondary);
            font-size: 1.1rem;
        }
        
        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .invoice-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .invoice-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .invoice-table tr:last-child td {
            border-bottom: none;
        }
        
        .invoice-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .text-right {
            text-align: right;
        }
        
        .text-center {
            text-align: center;
        }
        
        .totals-section {
            margin-top: 25px;
            border-top: 2px solid #eee;
            padding-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-weight: 600;
            padding: 5px 0;
        }
        
        .grand-total {
            font-size: 1.4rem;
            color: var(--primary);
            border-top: 2px solid #eee;
            padding-top: 15px;
            margin-top: 15px;
        }
        
        .invoice-footer {
            margin-top: 40px;
            text-align: center;
            color: #777;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            color: var(--dark);
            font-size: 1rem;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .footer-text {
            margin-top: 10px;
            color: var(--secondary);
            font-weight: 600;
        }
        
        .status-badge {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-paid {
            background: #e7f7ef;
            color: #10b981;
        }
        
        .status-unpaid {
            background: #fef3f2;
            color: #f04438;
        }
        
        .status-partial {
            background: #fffaeb;
            color: #f79009;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Professional Invoice Generator</h1>
            <p class="subtitle">Create beautiful, customized invoices for your business</p>
        </header>
        
        <div class="main-content">
            <div class="form-section">
                <h2 class="section-title">
                    <i>üìã</i> Invoice Details
                </h2>
                
                <div class="form-group">
                    <label for="business-name">Business Name</label>
                    <input type="text" id="business-name" placeholder="Enter your business name">
                </div>
                
                <div class="form-group">
                    <label for="business-address">Business Address</label>
                    <textarea id="business-address" rows="3" placeholder="Enter your business address"></textarea>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="business-phone">Business Phone</label>
                        <input type="text" id="business-phone" placeholder="Phone number">
                    </div>
                    <div class="form-group">
                        <label for="business-email">Business Email</label>
                        <input type="email" id="business-email" placeholder="Email address">
                    </div>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">
                    <i>üë§</i> Customer Details
                </h2>
                
                <div class="form-group">
                    <label for="customer-name">Customer Name</label>
                    <input type="text" id="customer-name" placeholder="Enter customer name">
                </div>
                
                <div class="form-group">
                    <label for="customer-address">Customer Address</label>
                    <textarea id="customer-address" rows="2" placeholder="Enter customer address"></textarea>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="customer-phone">Customer Phone</label>
                        <input type="text" id="customer-phone" placeholder="Phone number">
                    </div>
                    <div class="form-group">
                        <label for="customer-email">Customer Email</label>
                        <input type="email" id="customer-email" placeholder="Email address">
                    </div>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">
                    <i>üìÑ</i> Invoice Information
                </h2>
                
                <div class="row">
                    <div class="form-group">
                        <label for="invoice-number">Invoice Number</label>
                        <input type="text" id="invoice-number" placeholder="e.g., INV-001">
                    </div>
                    <div class="form-group">
                        <label for="invoice-date">Invoice Date</label>
                        <input type="date" id="invoice-date">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="currency">Currency</label>
                    <select id="currency">
                        <option value="$">US Dollar ($)</option>
                        <option value="‚Ç¨">Euro (‚Ç¨)</option>
                        <option value="¬£">British Pound (¬£)</option>
                        <option value="‚Çπ">Indian Rupee (‚Çπ)</option>
                        <option value="¬•">Japanese Yen (¬•)</option>
                        <option value="‚Ç®">Pakistani Rupee (‚Ç®)</option>
                        <option value="AED">UAE Dirham (AED)</option>
                        <option value="SAR">Saudi Riyal (SAR)</option>
                        <option value="CAD">Canadian Dollar (CAD)</option>
                        <option value="AUD">Australian Dollar (AUD)</option>
                    </select>
                </div>
                
                <h2 class="section-title" style="margin-top: 30px;">
                    <i>üßÆ</i> Tax Settings
                </h2>
                
                <div class="tax-section" id="tax-container">
                    <!-- Tax rows will be added here dynamically -->
                    <div class="tax-row">
                        <input type="text" class="tax-name" placeholder="Tax Name (e.g., VAT)" value="Sales Tax">
                        <input type="number" class="tax-rate" placeholder="Rate %" min="0" step="0.1" value="10">
                        <div class="tax-actions">
                            <button class="tax-btn remove" onclick="removeTax(this)">‚úï</button>
                        </div>
                    </div>
                </div>
                
                <button class="add-tax" id="add-tax">
                    <span>+</span> Add Tax
                </button>
                
                <h2 class="section-title" style="margin-top: 30px;">
                    <i>üì¶</i> Products / Services
                </h2>
                
                <div class="products-section" id="products-container">
                    <!-- Product items will be added here dynamically -->
                </div>
                
                <button class="add-product" id="add-product">
                    <span>+</span> Add Product or Service
                </button>
                
                <div class="form-group">
                    <label>Invoice Status</label>
                    <div class="invoice-status">
                        <div class="status-option status-paid active" data-status="paid">Paid</div>
                        <div class="status-option status-unpaid" data-status="unpaid">Unpaid</div>
                        <div class="status-option status-partial" data-status="partial">Partially Paid</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes" rows="3" placeholder="Any additional notes..."></textarea>
                </div>
                
                <button class="generate-btn" id="generate-pdf">
                    <span>üìÑ</span> Generate PDF Invoice
                </button>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title">
                    <i>üëÅÔ∏è</i> Invoice Preview
                </h2>
                <div class="preview-container">
                    <div class="invoice-preview" id="invoice-preview">
                        <div class="empty-state">
                            <div>üìä</div>
                            <h3>Invoice Preview</h3>
                            <p>Fill out the form to see a preview of your beautiful invoice</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Free for everyone | Made by <strong>SiteArche</strong> (sitearche.com)</p>
            <p class="footer-text">Made with ‚ù§Ô∏è in Pakistan</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            document.getElementById('invoice-date').valueAsDate = new Date();
            
            // Generate a random invoice number
            document.getElementById('invoice-number').value = 'INV-' + Math.floor(1000 + Math.random() * 9000);
            
            // Add first product row
            addProductItem();
            
            // Status selection
            const statusOptions = document.querySelectorAll('.status-option');
            statusOptions.forEach(option => {
                option.addEventListener('click', function() {
                    statusOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    updatePreview();
                });
            });
            
            // Add product button
            document.getElementById('add-product').addEventListener('click', addProductItem);
            
            // Add tax button
            document.getElementById('add-tax').addEventListener('click', addTaxRow);
            
            // Generate PDF button
            document.getElementById('generate-pdf').addEventListener('click', generatePDF);
            
            // Update preview when form changes
            const formInputs = document.querySelectorAll('input, select, textarea');
            formInputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            // Initial preview update
            updatePreview();
        });
        
        let productCount = 0;
        
        function addProductItem() {
            productCount++;
            const productsContainer = document.getElementById('products-container');
            
            const productItem = document.createElement('div');
            productItem.className = 'product-item';
            productItem.innerHTML = `
                <div class="product-header">
                    <h3>Product / Service #${productCount}</h3>
                    <button class="remove-product" onclick="removeProductItem(this)">Remove</button>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" class="product-desc" placeholder="Product or service description">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Quantity</label>
                        <input type="number" class="product-qty" min="1" value="1">
                    </div>
                    <div class="form-group">
                        <label>Unit Price</label>
                        <input type="number" class="product-price" min="0" step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>Discount (%)</label>
                        <input type="number" class="product-discount" min="0" max="100" value="0" placeholder="0">
                    </div>
                </div>
            `;
            
            productsContainer.appendChild(productItem);
            
            // Add event listeners to new inputs
            const newInputs = productItem.querySelectorAll('input');
            newInputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            updatePreview();
        }
        
        function removeProductItem(button) {
            const productItem = button.closest('.product-item');
            productItem.remove();
            updatePreview();
        }
        
        function addTaxRow() {
            const taxContainer = document.getElementById('tax-container');
            
            const taxRow = document.createElement('div');
            taxRow.className = 'tax-row';
            taxRow.innerHTML = `
                <input type="text" class="tax-name" placeholder="Tax Name (e.g., VAT)">
                <input type="number" class="tax-rate" placeholder="Rate %" min="0" step="0.1" value="0">
                <div class="tax-actions">
                    <button class="tax-btn remove" onclick="removeTax(this)">‚úï</button>
                </div>
            `;
            
            taxContainer.appendChild(taxRow);
            
            // Add event listeners to new inputs
            const newInputs = taxRow.querySelectorAll('input');
            newInputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            updatePreview();
        }
        
        function removeTax(button) {
            const taxRow = button.closest('.tax-row');
            // Don't remove if it's the last tax row
            if (document.querySelectorAll('.tax-row').length > 1) {
                taxRow.remove();
                updatePreview();
            }
        }
        
        function updatePreview() {
            const preview = document.getElementById('invoice-preview');
            const businessName = document.getElementById('business-name').value || 'Your Business Name';
            const businessAddress = document.getElementById('business-address').value || 'Your Business Address';
            const businessPhone = document.getElementById('business-phone').value || 'Your Phone';
            const businessEmail = document.getElementById('business-email').value || 'Your Email';
            
            const customerName = document.getElementById('customer-name').value || 'Customer Name';
            const customerAddress = document.getElementById('customer-address').value || 'Customer Address';
            const customerPhone = document.getElementById('customer-phone').value || 'Customer Phone';
            const customerEmail = document.getElementById('customer-email').value || 'Customer Email';
            
            const invoiceNumber = document.getElementById('invoice-number').value || 'INV-0001';
            const invoiceDate = document.getElementById('invoice-date').value || new Date().toISOString().split('T')[0];
            const currency = document.getElementById('currency').value;
            const notes = document.getElementById('notes').value;
            
            const statusOption = document.querySelector('.status-option.active');
            const status = statusOption ? statusOption.getAttribute('data-status') : 'unpaid';
            
            // Get products
            const productItems = document.querySelectorAll('.product-item');
            let productsHTML = '';
            let subtotal = 0;
            
            productItems.forEach(item => {
                const desc = item.querySelector('.product-desc').value || 'Product/Service';
                const qty = parseFloat(item.querySelector('.product-qty').value) || 0;
                const price = parseFloat(item.querySelector('.product-price').value) || 0;
                const discount = parseFloat(item.querySelector('.product-discount').value) || 0;
                
                const discountAmount = (price * discount / 100) * qty;
                const total = (price * qty) - discountAmount;
                subtotal += total;
                
                productsHTML += `
                    <tr>
                        <td>${desc}</td>
                        <td>${qty}</td>
                        <td>${currency}${price.toFixed(2)}</td>
                        <td>${discount}%</td>
                        <td class="text-right">${currency}${total.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            // Get taxes
            const taxRows = document.querySelectorAll('.tax-row');
            let taxesHTML = '';
            let totalTax = 0;
            
            taxRows.forEach(row => {
                const taxName = row.querySelector('.tax-name').value || 'Tax';
                const taxRate = parseFloat(row.querySelector('.tax-rate').value) || 0;
                
                if (taxRate > 0) {
                    const taxAmount = subtotal * (taxRate / 100);
                    totalTax += taxAmount;
                    
                    taxesHTML += `
                        <div class="total-row">
                            <div>${taxName} (${taxRate}%):</div>
                            <div>${currency}${taxAmount.toFixed(2)}</div>
                        </div>
                    `;
                }
            });
            
            const grandTotal = subtotal + totalTax;
            
            let statusBadge = '';
            if (status === 'paid') {
                statusBadge = '<span class="status-badge status-paid">Paid</span>';
            } else if (status === 'unpaid') {
                statusBadge = '<span class="status-badge status-unpaid">Unpaid</span>';
            } else if (status === 'partial') {
                statusBadge = '<span class="status-badge status-partial">Partially Paid</span>';
            }
            
            // Only show preview if we have at least some data
            if (businessName !== 'Your Business Name' || customerName !== 'Customer Name' || productItems.length > 0) {
                preview.innerHTML = `
                    <div class="invoice-header">
                        <div>
                            <div class="invoice-title">INVOICE</div>
                            <div class="invoice-id">${invoiceNumber} ${statusBadge}</div>
                        </div>
                        <div>
                            <div><strong>Date:</strong> ${formatDate(invoiceDate)}</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="company-info">
                            <div class="info-title">FROM:</div>
                            <div><strong>${businessName}</strong></div>
                            <div>${businessAddress.replace(/\n/g, '<br>')}</div>
                            <div>Phone: ${businessPhone}</div>
                            <div>Email: ${businessEmail}</div>
                        </div>
                        
                        <div class="client-info">
                            <div class="info-title">BILL TO:</div>
                            <div><strong>${customerName}</strong></div>
                            <div>${customerAddress.replace(/\n/g, '<br>')}</div>
                            <div>Phone: ${customerPhone}</div>
                            <div>Email: ${customerEmail}</div>
                        </div>
                    </div>
                    
                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Qty</th>
                                <th>Unit Price</th>
                                <th>Discount</th>
                                <th class="text-right">Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${productsHTML || '<tr><td colspan="5" class="text-center">No products added</td></tr>'}
                        </tbody>
                    </table>
                    
                    <div class="totals-section">
                        <div class="total-row">
                            <div>Subtotal:</div>
                            <div>${currency}${subtotal.toFixed(2)}</div>
                        </div>
                        ${taxesHTML}
                        <div class="total-row grand-total">
                            <div>Total:</div>
                            <div>${currency}${grandTotal.toFixed(2)}</div>
                        </div>
                    </div>
                    
                    ${notes ? `
                    <div class="notes-section">
                        <div class="info-title">Notes:</div>
                        <div>${notes.replace(/\n/g, '<br>')}</div>
                    </div>
                    ` : ''}
                    
                    <div class="invoice-footer">
                        Thank you for your business!<br>
                        Free for everyone | Made by <strong>SiteArche</strong> (sitearche.com)<br>
                        Made with ‚ù§Ô∏è in Pakistan
                    </div>
                `;
            } else {
                preview.innerHTML = `
                    <div class="empty-state">
                        <div>üìä</div>
                        <h3>Invoice Preview</h3>
                        <p>Fill out the form to see a preview of your beautiful invoice</p>
                    </div>
                `;
            }
        }
        
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }
        
        function generatePDF() {
            // Use html2canvas to capture the preview as an image
            const preview = document.getElementById('invoice-preview');
            
            // Show loading state
            const generateBtn = document.getElementById('generate-pdf');
            const originalText = generateBtn.innerHTML;
            generateBtn.innerHTML = '<span>‚è≥</span> Generating PDF...';
            generateBtn.disabled = true;
            
            html2canvas(preview, {
                scale: 2, // Higher quality
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                const pageWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();
                
                // Add the captured image to PDF
                doc.addImage(imgData, 'JPEG', 0, 0, pageWidth, pageHeight);
                
                // Save the PDF
                const invoiceNumber = document.getElementById('invoice-number').value || 'INV-0001';
                doc.save(`invoice-${invoiceNumber}.pdf`);
                
                // Restore button state
                generateBtn.innerHTML = originalText;
                generateBtn.disabled = false;
            }).catch(error => {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF. Please try again.');
                
                // Restore button state
                generateBtn.innerHTML = originalText;
                generateBtn.disabled = false;
            });
        }
    </script>
</body>
</html>
